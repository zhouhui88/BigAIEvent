<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI大事件</title>
  <style>
    :root {
      --paper: #fbf7ef;
      --ink: #111827;
      --muted: #6b7280;
      --card: #ffffff;
      --border: #ece5d8;
      --link: #1d4ed8;
      --accent: #b91c1c;
    }
    body {
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei";
      background: var(--paper);
      color: var(--ink);
    }
    header { padding: 26px 18px 12px; max-width: 980px; margin:0 auto; }
    .masthead { border-bottom: 3px solid var(--ink); padding-bottom: 12px; }
    .brand { font-size: 12px; letter-spacing: 0.14em; text-transform: uppercase; color: var(--accent); font-weight: 700; margin-bottom: 6px; }
    h1 { margin:0; font-size: 28px; line-height: 1.15; font-weight: 800; }
    main { max-width: 980px; margin:0 auto; padding: 14px 18px 46px; }
    .list { list-style: decimal; padding-left: 22px; margin: 14px 0 0; display:flex; flex-direction:column; gap: 12px; }
    .card {
      list-style-position: outside;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 14px 16px;
      box-shadow: 0 1px 0 rgba(17,24,39,0.04);
    }
    .title { font-size: 16px; font-weight: 800; margin: 0 0 8px; line-height:1.35; }
    .sources { margin: 8px 0 10px; font-size: 12px; color: var(--muted); display:flex; flex-wrap: wrap; gap: 10px; }
    .sources a { color: var(--link); text-decoration: none; border-bottom: 1px solid rgba(29,78,216,0.25); }
    .sources a:hover { text-decoration: underline; }
    .content { color: #111827; font-size: 13px; line-height:1.6; }
    .error { color:#b91c1c; font-size: 13px; }
  </style>
</head>
<body>
  <header>
    <div class="masthead">
      <div class="brand">AI 早报</div>
      <h1 id="title">AI大事件</h1>
    </div>
  </header>
  <main>
    <div id="err" class="error" style="display:none"></div>
    <ol id="list" class="list"></ol>
  </main>

<script>
  function esc(s){return (s??"").toString().replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")}

  async function load(){
    try{
      const res = await fetch('./data.json', { cache: 'no-store' });
      if(!res.ok) throw new Error('无法加载 data.json: HTTP ' + res.status);
      const data = await res.json();
      window.__data = data;
      document.getElementById('title').textContent = (data.displayTitle || data.title || 'AI大事件');
      render();
    }catch(e){
      document.getElementById('subtitle').textContent = '加载失败';
      const err = document.getElementById('err');
      err.style.display='block';
      err.textContent = e.message;
    }
  }

  function render(){
    let items = (window.__data?.items || []).slice();
    // sort by hotness desc (fallback: 0)
    items.sort((a,b) => (b.hotness||0) - (a.hotness||0));

    const root = document.getElementById('list');
    root.innerHTML = items.map(x => {
      const sources = (x.sources||[]).map(s => {
        const name = s.name ? esc(s.name) : '来源';
        // Show domain for quick scan
        let domain = '';
        try { domain = new URL(s.url).hostname.replace(/^www\./,''); } catch(e) { domain = ''; }
        const label = domain ? `${name}（${esc(domain)}）` : name;
        return `<span><a href="${esc(s.url)}" target="_blank" rel="noreferrer">${label}</a></span>`;
      }).join('');

      return `
        <li class="card">
          <div class="title">${esc(x.title)}</div>
          <div class="sources">${sources}</div>
          <div class="content">${esc(x.summary).replaceAll('\n','<br>')}</div>
        </li>
      `;
    }).join('');
  }

  load();
</script>
</body>
</html>
